<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico">
    <title>DineInsight Pro</title>
    <link rel="stylesheet" href="./css/style.css">
    <script type="module" src="./js/index.js"></script>
    <script type='text/javascript'>
        window.smartlook||(function(d) {
            var o=smartlook=function(){ o.api.push(arguments)},h=d.getElementsByTagName('head')[0];
            var c=d.createElement('script');o.api=new Array();c.async=true;c.type='text/javascript';
            c.charset='utf-8';c.src='https://web-sdk.smartlook.com/recorder.js';h.appendChild(c);
            })(document);
            smartlook('init', '7bad782d17cf34b87fc910b034ee66ea6f28e09b', { region: 'eu' });
    </script>
</head>
<body>
    <div class="header">
        <a href="index.html" class="no-padding"> <img src="../assets/logos/DS_Logo.PNG" alt="DineInsight Logo"></a>
        <div class="header-right">
          <a class="active" href="index.html">Home</a>
            <a href="html/objects.html">Objects</a>
            <a href="html/favorites.html">Favorites</a>
            <a href="html/order.html">Order</a>
            <a href="html/charts.html">Charts</a>
            <a href="html/contact.html">Contact</a>
        </div>
      </div>

    <div class="headerExpand" id="searchResults">
        <div class="container"></div>
    </div>
    <main class="container">
        <h1>Welcome to DineInsight Pro</h1>
        <div>
            <h2>Abgeschlossene Bestellungen</h2>
            <div id='show-orders'></div>
            <script>  
                const completedOrders = JSON.parse(localStorage.getItem('completedOrders')) || [];
                const showOrders = document.getElementById('show-orders');

                const allOrderIds = completedOrders.map(order => order.orderId);

                allOrderIds.map((orderID, index) => {
                    const orderContainer = document.createElement('div');
                    orderContainer.classList.add('order-container');

                    const date = new Date(orderID)

                    const year = date.getFullYear();
                    const month = date.getMonth() + 1; // Months are zero-indexed, so we add 1
                    const day = date.getDate();
                    const hours = date.getHours();
                    const minutes = date.getMinutes();

                    const orderNumber = index + 1

                    const orderTitle = document.createElement('h3');
                    orderTitle.textContent = 'Bestellung ' + orderNumber  + ' vom ' + `${year}-${month < 10 ? '0' + month : month}-${day < 10 ? '0' + day : day} ${hours < 10 ? '0' + hours : hours}:${minutes < 10 ? '0' + minutes : minutes}`;
                    orderContainer.appendChild(orderTitle);

                    let totalPrice = 0
                    completedOrders.map((item, newIndex) => {
                        console.log(item)
                        if (item.orderId == orderID) {
                            const itemElement = document.createElement('p');
                            itemElement.textContent = `- ${item.title} ${item.price}$`;
                            orderContainer.appendChild(itemElement); 
                            totalPrice = totalPrice + item.price
                        }
                    })

                    const itemElement = document.createElement('p');
                    itemElement.textContent = `Total ${totalPrice}$`;
                    orderContainer.appendChild(itemElement); 

                    showOrders.appendChild(orderContainer);
                })
        
                // completedOrders.forEach((order, index) => {
                //     // Erstellen eines Containers für jede Bestellung
                //     const orderContainer = document.createElement('div');
                //     orderContainer.classList.add('order-container');

                    
        
                //     // Hinzufügen eines Titels für jede Bestellung
                //     const orderTitle = document.createElement('h3');
                //     orderTitle.textContent = 'Bestellung ' + (index + 1);
                //     orderContainer.appendChild(orderTitle);
        
                //     // Gehen Sie durch jedes Objekt in der Bestellung
                //     // order.forEach(item => {
                //         const itemElement = document.createElement('p');
                //         itemElement.textContent = order.title + ' ' + order.orderId; // Verwenden des Titels aus dem Bestellungsobjekt
                //         orderContainer.appendChild(itemElement); // Hinzufügen des Elements zum Bestellungscontainer
                //     // });
        
                //     // Hinzufügen des Bestellungscontainers zum Hauptcontainer
                //     showOrders.appendChild(orderContainer);
                // });
            </script>
        </div>
        
        
        

        <div class="recomendationsContainer">
            <h2>Todays Recomendations</h2>
            <div id="objectDisplay-Container"></div>
        </div>
    </main>
    
    <footer>
        <div class="container">
            <div class="spacer"></div>
            <p>&copy; 2023 Lunchtracker. All rights reserved.</p>
            <p><a href="https://github.com/loiicd/portfolio-webprogrammierung" target="_blank">View in the Github</a></p>
            <p><a href="./html/impressum.html">Impressum</a></p>
        </div>
    </footer>
</body>
</html>
